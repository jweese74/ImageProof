{% extends 'base.html' %}

{% block title %}Dashboard - ImageProof{% endblock %}

{% block csrf_token %}
    {{ csrf_token }}
{% endblock %}

{% block content %}
<section class="dashboard">
    <h1>Welcome, {{ current_user.username }}!</h1>

    <section class="registered-images">
        <h2>Your Registered Images</h2>
        {% if images %}
            <div class="image-grid">
                {% for image in images %}
                <div class="card image-card">
                    <h3>{{ image.title | e }}</h3>
                    <p class="text-muted">Registered {{ image.registered_at.strftime('%Y-%m-%d') }}</p>
                    <span class="status {{ image.status | lower }}">{{ image.status }}</span>
                    <div class="actions">
                        <a href="{{ url_for('member.view_image', image_id=image.id) }}" class="btn" aria-label="View details of {{ image.title }}">View Details</a>
                        <a href="{{ url_for('member.download_certificate', image_id=image.id) }}" class="btn" aria-label="Download certificate for {{ image.title }}">Download Certificate</a>
                        <a href="{{ url_for('member.transfer_image', image_id=image.id) }}" class="btn" aria-label="Transfer ownership of {{ image.title }}">Transfer Ownership</a>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <p class="text-muted">You have no registered images yet.</p>
        {% endif %}
    </section>

    <section class="notifications">
        <h2>Notifications</h2>
        {% with messages = get_flashed_messages(with_categories=True) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert {{ category }}" role="alert">{{ message }}</div>
                {% endfor %}
            {% else %}
                <p class="text-muted">No notifications at this time.</p>
            {% endif %}
        {% endwith %}
    </section>

    <a href="{{ url_for('member.register_image') }}" class="btn">Register New Image</a>
</section>
{% endblock %}

{% block scripts %}
{{ super() }}
{% endblock %}